# @paisabazaar/sso-react

[![N|Solid](https://www.paisabazaar.com/wp-content/uploads/2017/10/489X100.png)](https://www.paisabazaar.com)

@paisabazaar/sso-react is a javascript based wrapper for paisabazaarSsoService.

### Installation

```sh
$ npm config set @paisabazaar:registry http://10.120.0.5:4873
$ npm install @paisabazaar/sso-react
```

# Methods
  - createLoginLink
  - createLogoutLink
  - sessionExists
  - getAuthorizationCode
  - logout
  - sendOtp

### Initialize
```javascript
import PaisabazaarSsoReact  from @paisabazaar/sso-react;
let paisabazaarSsoReactObj = new PaisabazaarSsoReact(configuration, additionalData = {});
```

### Configuration
```javascript
{
        "environment"       : "development",
        "accountsUrl"       : "http://accounts.sso.local",
        "clientId"          : "5786711d-5a5d-444f-a5af-632a5b5d9853",
        "redirectLoginUri"  : "http://gold.sso.local/digital-gold/authorize",
        "redirectLogoutUri" : "http://gold.sso.local/digital-gold/logout",
        "scope"             : "digitalGoldSitePlatformApi",
        "siteId"            : "aaaaa-1234-42af-9550-e50988b0b69a",
        "encryptionKey"     : "abcd12345",
        "tokenSource"       : "cookie"
    }
```

| name | description | required | default | possible values
|---|---|---|---|---
| environment | Development Environment  | N | development | development, production
| clientId | To be shared by sso admin | Y | - | -
| redirectLoginUri | URL to redirect after login | Y | - | -
| redirectLogoutUri | URL to redirect after logout | Y | - | -
| scope | Services to access. Commma separted in case of multiple | Y | - | -
| siteId | Required in case of authentication implementation at client's end | N | - | -
| encryptionKey | Required in case of authentication implementation at client's end | N | - | -
| tokenSource | glss data source | N | cookie | cookie, custom


### createLoginLink (state, authType = 'otp', options = {}) 

Params
| name | description | required | default
|---|---|---|---
| state | Unique Identifier of request  | Y | -
| authType | type of authtication request | N | otp
| options |  options | N | {}
| options.screenType | customizable screen if any | N | 0
| options.additionalData | additional params to append in url (mobileNo, etc..) These params will be returned with redirect url | N | -

Example
```javascript
paisabazaarSsoReactObj.createLoginLink('d3b48ffb-f323-4b13-8fa7-bbb2cc25b72d', 'otp', '0');

/*Returns
http://accounts.sso.local/authorize?client_id=5786711d-5a5d-444f-a5af-632a5b5d9853&redirect_uri=http%3A%2F%2Fgold.sso.local%2Fdigital-gold%2Fauthorize&state=d3b48ffb-f323-4b13-8fa7-bbb2cc25b72d&scope=digitalGoldSitePlatformApi&auth_type=otp
*/
```

### createLogoutLink ()

Example
```javascript
paisabazaarSsoReactObj.createLogoutLink();

/*Returns
http://accounts.sso.local/logout?redirect_uri=http%3A%2F%2Fgold.sso.local%2Fdigital-gold%2Flogout
*/
```

### sessionExists ()
Example
```javascript
paisabazaarSsoReactObj.sessionExists();

/* Returns
true | false
*/
```

### getAuthorizationCode (state, data = {})

Params
| name | description | required | default
|---|---|---|---
| state | Unique Identifier of request  | Y | -
| data | (mobileNo, visitorId, otp) [Mentioned in API DOC](https://staging-accounts.paisabazaar.com/SSOSP/api/#api-oauth-createAuthorizationCode) | Y (In case of authType otp) | -

Example
```javascript
paisabazaarSsoReactObj.getAuthorizationCode("843d721a-6f21-4d29-943d-ffe93360eadas", {
    "mobileNo"		: "9111111111",
    "visitorId"		: "4b5f9f58-2651-40d1-b29e-eaba206611dd",
    "otp"			: "1234",
});

/* Returns
{
        "authorizationCode": "ba32e4c5868007cc1d31f64594e7d718994bf78825140f7c57f125f15f20ee675b18e5f907734fc194577268a92280f8",
        "customerId": "5481a7b0-801b-44d0-8ee9-ca590fe87b31",
        "redirectUri": "http://gold.sso.local/digital-gold/authorize",
        "glssToken": "a970322d-1585-43a2-8f34-9db7be18b714",
        "expireAt": "2019-03-11 12:02:08",
        "state": "843d721a-6f21-4d29-943d-ffe93360eadas",
        "glssTokenExpireAt": "2019-03-11T08:27:08.882Z"
    }
*/
```

### logout ()
Example
```javascript
paisabazaarSsoReactObj.logout();

```

### sendOtp (data = {})

Params
| name | description | required | default
|---|---|---|---
| data | (mobileNo, visitorId) | Y | -

Example
```javascript
paisabazaarSsoReactObj.sendOtp( {
    "mobileNo"		: "9111111111",
    "visitorId"		: "4b5f9f58-2651-40d1-b29e-eaba206611dd"
});

/* Returns
{
	"visitorId": "04d2fe75-f56b-4b10-9905-79d3194520eb",
	"mobileNo": "9111111111"
}
*/
```