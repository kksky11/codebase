"use strict";

var utility = require("./utility"); // SOURCE CODE:  https://stackoverflow.com/a/66938952/6883777


var encrypt = function encrypt(salt, text) {
  if (utility.isEmpty(salt) || utility.isEmpty(text)) {
    return;
  }

  var textToChars = function textToChars(text) {
    return text.split("").map(function (c) {
      return c.charCodeAt(0);
    });
  };

  var byteHex = function byteHex(n) {
    return ("0" + Number(n).toString(16)).substr(-2);
  };

  var applySaltToChar = function applySaltToChar(code) {
    return textToChars(salt).reduce(function (a, b) {
      return a ^ b;
    }, code);
  };

  return text.split("").map(textToChars).map(applySaltToChar).map(byteHex).join("");
};

var decrypt = function decrypt(salt, encoded) {
  if (utility.isEmpty(salt) || utility.isEmpty(encoded)) {
    return;
  }

  var textToChars = function textToChars(text) {
    return text.split("").map(function (c) {
      return c.charCodeAt(0);
    });
  };

  var applySaltToChar = function applySaltToChar(code) {
    return textToChars(salt).reduce(function (a, b) {
      return a ^ b;
    }, code);
  };

  return encoded.match(/.{1,2}/g).map(function (hex) {
    return parseInt(hex, 16);
  }).map(applySaltToChar).map(function (charCode) {
    return String.fromCharCode(charCode);
  }).join("");
};

module.exports = {
  encrypt: encrypt,
  decrypt: decrypt
};